{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 95, "column": 0}, "map": {"version":3,"sources":["file:///Users/yersultan/developer/work_projects/gp-consulting-2/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  throw new Error('Missing Supabase environment variables. Please check your .env file.');\n}\n\nconsole.log('Initializing Supabase client with:', {\n  url: supabaseUrl,\n  hasAnonKey: !!supabaseAnonKey\n});\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\n  auth: {\n    autoRefreshToken: true,\n    persistSession: true,\n    detectSessionInUrl: true\n  },\n  db: {\n    schema: 'public'\n  },\n  global: {\n    headers: {\n      'x-client-info': 'gp-consulting-2'\n    }\n  },\n  // Add reasonable timeouts\n  realtime: {\n    timeout: 10000 // 10 seconds\n  }\n});\n\n// Test the connection and RLS policies\n(async () => {\n  try {\n    console.log('Testing Supabase connection and RLS policies...');\n    \n    // Test solutions table with detailed error logging\n    const { data: solutions, error: solutionsError } = await supabase\n      .from('solutions')\n      .select('*')\n      .limit(1);\n\n    if (solutionsError) {\n      console.error('Error accessing solutions table:', solutionsError);\n      if (solutionsError.code === 'PGRST301') {\n        console.error('RLS policy might be blocking access. Please check your Supabase RLS policies.');\n      }\n    } else {\n      console.log('Successfully accessed solutions table. Row count:', solutions?.length);\n    }\n\n  } catch (error) {\n    console.error('Supabase connection test failed:', error);\n  }\n})(); "],"names":[],"mappings":";;;AAAA;;AAEA,MAAM;AACN,MAAM;AAEN,uCAAsC;;AAEtC;AAEA,QAAQ,GAAG,CAAC,sCAAsC;IAChD,KAAK;IACL,YAAY,CAAC,CAAC;AAChB;AAEO,MAAM,WAAW,CAAA,GAAA,uLAAA,CAAA,eAAY,AAAD,EAAE,aAAa,iBAAiB;IACjE,MAAM;QACJ,kBAAkB;QAClB,gBAAgB;QAChB,oBAAoB;IACtB;IACA,IAAI;QACF,QAAQ;IACV;IACA,QAAQ;QACN,SAAS;YACP,iBAAiB;QACnB;IACF;IACA,0BAA0B;IAC1B,UAAU;QACR,SAAS,MAAM,aAAa;IAC9B;AACF;AAEA,uCAAuC;AACvC,CAAC;IACC,IAAI;QACF,QAAQ,GAAG,CAAC;QAEZ,mDAAmD;QACnD,MAAM,EAAE,MAAM,SAAS,EAAE,OAAO,cAAc,EAAE,GAAG,MAAM,SACtD,IAAI,CAAC,aACL,MAAM,CAAC,KACP,KAAK,CAAC;QAET,IAAI,gBAAgB;YAClB,QAAQ,KAAK,CAAC,oCAAoC;YAClD,IAAI,eAAe,IAAI,KAAK,YAAY;gBACtC,QAAQ,KAAK,CAAC;YAChB;QACF,OAAO;YACL,QAAQ,GAAG,CAAC,qDAAqD,WAAW;QAC9E;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,oCAAoC;IACpD;AACF,CAAC","debugId":null}},
    {"offset": {"line": 176, "column": 0}, "map": {"version":3,"sources":["file:///Users/yersultan/developer/work_projects/gp-consulting-2/src/components/admin/sidebar.tsx"],"sourcesContent":["'use client';\n\nimport Link from 'next/link';\nimport { usePathname } from 'next/navigation';\nimport { cn } from '@/lib/utils';\nimport {\n  LayoutDashboard,\n  Factory,\n  Lightbulb,\n  Trophy,\n  LogOut,\n  Briefcase\n} from 'lucide-react';\nimport { supabase } from '@/lib/supabase';\n\nconst navigation = [\n  { name: 'Dashboard', href: '/admin', icon: LayoutDashboard },\n  { name: 'Industries', href: '/admin/industries', icon: Factory },\n  { name: 'Solutions', href: '/admin/solutions', icon: Lightbulb },\n  { name: 'Achievements', href: '/admin/achievements', icon: Trophy },\n  { name: 'Cases', href: '/admin/cases', icon: Briefcase },\n];\n\nexport function AdminSidebar() {\n  const pathname = usePathname();\n\n  const handleSignOut = async () => {\n    await supabase.auth.signOut();\n    window.location.href = '/auth/login';\n  };\n\n  return (\n    <div className=\"flex flex-col w-64 bg-white border-r\">\n      <div className=\"flex-1 flex flex-col pt-5 pb-4 overflow-y-auto\">\n        <div className=\"flex items-center flex-shrink-0 px-4\">\n          <h1 className=\"text-xl font-semibold text-gray-900\">Admin Panel</h1>\n        </div>\n        <nav className=\"mt-8 flex-1 px-2 space-y-1\">\n          {navigation.map((item) => {\n            const isActive = pathname === item.href;\n            return (\n              <Link\n                key={item.name}\n                href={item.href}\n                className={cn(\n                  'group flex items-center px-2 py-2 text-sm font-medium rounded-md',\n                  isActive\n                    ? 'bg-gray-100 text-gray-900'\n                    : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900'\n                )}\n              >\n                <item.icon\n                  className={cn(\n                    'mr-3 h-5 w-5',\n                    isActive\n                      ? 'text-gray-500'\n                      : 'text-gray-400 group-hover:text-gray-500'\n                  )}\n                />\n                {item.name}\n              </Link>\n            );\n          })}\n        </nav>\n      </div>\n      <div className=\"flex-shrink-0 flex border-t p-4\">\n        <button\n          onClick={handleSignOut}\n          className=\"flex-shrink-0 w-full group flex items-center px-2 py-2 text-sm font-medium text-red-600 hover:bg-red-50 rounded-md\"\n        >\n          <LogOut className=\"mr-3 h-5 w-5\" />\n          Sign Out\n        </button>\n      </div>\n    </div>\n  );\n} "],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AAbA;;;;;;;AAeA,MAAM,aAAa;IACjB;QAAE,MAAM;QAAa,MAAM;QAAU,MAAM,4NAAA,CAAA,kBAAe;IAAC;IAC3D;QAAE,MAAM;QAAc,MAAM;QAAqB,MAAM,wMAAA,CAAA,UAAO;IAAC;IAC/D;QAAE,MAAM;QAAa,MAAM;QAAoB,MAAM,4MAAA,CAAA,YAAS;IAAC;IAC/D;QAAE,MAAM;QAAgB,MAAM;QAAuB,MAAM,sMAAA,CAAA,SAAM;IAAC;IAClE;QAAE,MAAM;QAAS,MAAM;QAAgB,MAAM,4MAAA,CAAA,YAAS;IAAC;CACxD;AAEM,SAAS;IACd,MAAM,WAAW,CAAA,GAAA,kIAAA,CAAA,cAAW,AAAD;IAE3B,MAAM,gBAAgB;QACpB,MAAM,sHAAA,CAAA,WAAQ,CAAC,IAAI,CAAC,OAAO;QAC3B,OAAO,QAAQ,CAAC,IAAI,GAAG;IACzB;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BAAG,WAAU;sCAAsC;;;;;;;;;;;kCAEtD,8OAAC;wBAAI,WAAU;kCACZ,WAAW,GAAG,CAAC,CAAC;4BACf,MAAM,WAAW,aAAa,KAAK,IAAI;4BACvC,qBACE,8OAAC,4JAAA,CAAA,UAAI;gCAEH,MAAM,KAAK,IAAI;gCACf,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,oEACA,WACI,8BACA;;kDAGN,8OAAC,KAAK,IAAI;wCACR,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,gBACA,WACI,kBACA;;;;;;oCAGP,KAAK,IAAI;;+BAjBL,KAAK,IAAI;;;;;wBAoBpB;;;;;;;;;;;;0BAGJ,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBACC,SAAS;oBACT,WAAU;;sCAEV,8OAAC,0MAAA,CAAA,SAAM;4BAAC,WAAU;;;;;;wBAAiB;;;;;;;;;;;;;;;;;;AAM7C","debugId":null}},
    {"offset": {"line": 323, "column": 0}, "map": {"version":3,"sources":["file:///Users/yersultan/developer/work_projects/gp-consulting-2/src/app/admin/check-admin.ts"],"sourcesContent":["import { supabase } from '@/lib/supabase';\n\nexport async function checkAndSetAdminRole() {\n  try {\n    const { data: { session } } = await supabase.auth.getSession();\n    if (!session?.user) {\n      console.log('No session found');\n      return false;\n    }\n\n    console.log('Checking admin role for user:', session.user.id);\n\n    // Check if user has a profile\n    const { data: profile, error: profileError } = await supabase\n      .from('profiles')\n      .select('*')\n      .eq('id', session.user.id)\n      .single();\n\n    if (profileError) {\n      console.error('Error checking profile:', profileError);\n      \n      // If the error is that the profile doesn't exist, create it\n      if (profileError.code === 'PGRST116') {\n        console.log('Profile not found, creating new profile');\n        const { error: insertError } = await supabase\n          .from('profiles')\n          .insert({\n            id: session.user.id,\n            role: 'admin'\n          });\n\n        if (insertError) {\n          console.error('Error creating profile:', insertError);\n          return false;\n        }\n\n        return true;\n      }\n      \n      return false;\n    }\n\n    console.log('Current profile:', profile);\n\n    // If profile exists but not admin, update to admin\n    if (!profile || profile.role !== 'admin') {\n      console.log('Updating profile to admin role');\n      const { error: updateError } = await supabase\n        .from('profiles')\n        .upsert({\n          id: session.user.id,\n          role: 'admin'\n        });\n\n      if (updateError) {\n        console.error('Error setting admin role:', updateError);\n        return false;\n      }\n\n      // Verify the update\n      const { data: verifyProfile, error: verifyError } = await supabase\n        .from('profiles')\n        .select('role')\n        .eq('id', session.user.id)\n        .single();\n\n      if (verifyError || verifyProfile?.role !== 'admin') {\n        console.error('Failed to verify admin role:', verifyError);\n        return false;\n      }\n\n      console.log('Successfully set admin role');\n    }\n\n    return true;\n  } catch (error) {\n    console.error('Error in checkAndSetAdminRole:', error);\n    return false;\n  }\n} "],"names":[],"mappings":";;;AAAA;;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,GAAG,MAAM,sHAAA,CAAA,WAAQ,CAAC,IAAI,CAAC,UAAU;QAC5D,IAAI,CAAC,SAAS,MAAM;YAClB,QAAQ,GAAG,CAAC;YACZ,OAAO;QACT;QAEA,QAAQ,GAAG,CAAC,iCAAiC,QAAQ,IAAI,CAAC,EAAE;QAE5D,8BAA8B;QAC9B,MAAM,EAAE,MAAM,OAAO,EAAE,OAAO,YAAY,EAAE,GAAG,MAAM,sHAAA,CAAA,WAAQ,CAC1D,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,QAAQ,IAAI,CAAC,EAAE,EACxB,MAAM;QAET,IAAI,cAAc;YAChB,QAAQ,KAAK,CAAC,2BAA2B;YAEzC,4DAA4D;YAC5D,IAAI,aAAa,IAAI,KAAK,YAAY;gBACpC,QAAQ,GAAG,CAAC;gBACZ,MAAM,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,sHAAA,CAAA,WAAQ,CAC1C,IAAI,CAAC,YACL,MAAM,CAAC;oBACN,IAAI,QAAQ,IAAI,CAAC,EAAE;oBACnB,MAAM;gBACR;gBAEF,IAAI,aAAa;oBACf,QAAQ,KAAK,CAAC,2BAA2B;oBACzC,OAAO;gBACT;gBAEA,OAAO;YACT;YAEA,OAAO;QACT;QAEA,QAAQ,GAAG,CAAC,oBAAoB;QAEhC,mDAAmD;QACnD,IAAI,CAAC,WAAW,QAAQ,IAAI,KAAK,SAAS;YACxC,QAAQ,GAAG,CAAC;YACZ,MAAM,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,sHAAA,CAAA,WAAQ,CAC1C,IAAI,CAAC,YACL,MAAM,CAAC;gBACN,IAAI,QAAQ,IAAI,CAAC,EAAE;gBACnB,MAAM;YACR;YAEF,IAAI,aAAa;gBACf,QAAQ,KAAK,CAAC,6BAA6B;gBAC3C,OAAO;YACT;YAEA,oBAAoB;YACpB,MAAM,EAAE,MAAM,aAAa,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,sHAAA,CAAA,WAAQ,CAC/D,IAAI,CAAC,YACL,MAAM,CAAC,QACP,EAAE,CAAC,MAAM,QAAQ,IAAI,CAAC,EAAE,EACxB,MAAM;YAET,IAAI,eAAe,eAAe,SAAS,SAAS;gBAClD,QAAQ,KAAK,CAAC,gCAAgC;gBAC9C,OAAO;YACT;YAEA,QAAQ,GAAG,CAAC;QACd;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;QAChD,OAAO;IACT;AACF","debugId":null}},
    {"offset": {"line": 387, "column": 0}, "map": {"version":3,"sources":["file:///Users/yersultan/developer/work_projects/gp-consulting-2/src/app/admin/layout.tsx"],"sourcesContent":["'use client';\n\nimport { supabase } from '@/lib/supabase';\nimport { AdminSidebar } from '@/components/admin/sidebar';\nimport { useEffect, useState } from 'react';\nimport { checkAndSetAdminRole } from './check-admin';\nimport { Loader2 } from 'lucide-react';\nimport { usePathname, useRouter } from 'next/navigation';\n\nexport default function AdminLayout({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  const [isLoading, setIsLoading] = useState(true);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const pathname = usePathname();\n  const router = useRouter();\n\n  useEffect(() => {\n    // Skip auth check for login page\n    if (pathname === '/admin/login') {\n      setIsLoading(false);\n      return;\n    }\n\n    let mounted = true;\n\n    async function checkAuth() {\n      try {\n        const { data: { session } } = await supabase.auth.getSession();\n        \n        if (!session?.user) {\n          console.log('No session found, redirecting to login');\n          router.push('/admin/login');\n          return;\n        }\n\n        // Check and set admin role\n        const isAdmin = await checkAndSetAdminRole();\n        if (!isAdmin) {\n          console.log('Not an admin, redirecting to login');\n          router.push('/admin/login');\n          return;\n        }\n\n        if (mounted) {\n          console.log('Admin role confirmed');\n          setIsAuthenticated(true);\n          setIsLoading(false);\n        }\n      } catch (error) {\n        console.error('Error checking auth:', error);\n        if (mounted) {\n          router.push('/admin/login');\n        }\n      } finally {\n        if (mounted) {\n          setIsLoading(false);\n        }\n      }\n    }\n\n    checkAuth();\n\n    // Subscribe to auth state changes\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(async (event) => {\n      if (!mounted) return;\n\n      if (event === 'SIGNED_IN') {\n        const isAdmin = await checkAndSetAdminRole();\n        setIsAuthenticated(isAdmin);\n        if (!isAdmin) {\n          router.push('/admin/login');\n        }\n      } else if (event === 'SIGNED_OUT') {\n        setIsAuthenticated(false);\n        router.push('/admin/login');\n      }\n    });\n\n    return () => {\n      mounted = false;\n      subscription.unsubscribe();\n    };\n  }, [pathname, router]);\n\n  // Return early for login page\n  if (pathname === '/admin/login') {\n    return children;\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <Loader2 className=\"w-8 h-8 animate-spin\" />\n      </div>\n    );\n  }\n\n  if (!isAuthenticated) {\n    return null;\n  }\n\n  return (\n    <div className=\"flex min-h-screen\">\n      <AdminSidebar />\n      <main className=\"flex-1 p-8\">{children}</main>\n    </div>\n  );\n} "],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAPA;;;;;;;;AASe,SAAS,YAAY,EAClC,QAAQ,EAGT;IACC,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvD,MAAM,WAAW,CAAA,GAAA,kIAAA,CAAA,cAAW,AAAD;IAC3B,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IAEvB,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,iCAAiC;QACjC,IAAI,aAAa,gBAAgB;YAC/B,aAAa;YACb;QACF;QAEA,IAAI,UAAU;QAEd,eAAe;YACb,IAAI;gBACF,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,GAAG,MAAM,sHAAA,CAAA,WAAQ,CAAC,IAAI,CAAC,UAAU;gBAE5D,IAAI,CAAC,SAAS,MAAM;oBAClB,QAAQ,GAAG,CAAC;oBACZ,OAAO,IAAI,CAAC;oBACZ;gBACF;gBAEA,2BAA2B;gBAC3B,MAAM,UAAU,MAAM,CAAA,GAAA,qIAAA,CAAA,uBAAoB,AAAD;gBACzC,IAAI,CAAC,SAAS;oBACZ,QAAQ,GAAG,CAAC;oBACZ,OAAO,IAAI,CAAC;oBACZ;gBACF;gBAEA,IAAI,SAAS;oBACX,QAAQ,GAAG,CAAC;oBACZ,mBAAmB;oBACnB,aAAa;gBACf;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,wBAAwB;gBACtC,IAAI,SAAS;oBACX,OAAO,IAAI,CAAC;gBACd;YACF,SAAU;gBACR,IAAI,SAAS;oBACX,aAAa;gBACf;YACF;QACF;QAEA;QAEA,kCAAkC;QAClC,MAAM,EAAE,MAAM,EAAE,YAAY,EAAE,EAAE,GAAG,sHAAA,CAAA,WAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC,OAAO;YACxE,IAAI,CAAC,SAAS;YAEd,IAAI,UAAU,aAAa;gBACzB,MAAM,UAAU,MAAM,CAAA,GAAA,qIAAA,CAAA,uBAAoB,AAAD;gBACzC,mBAAmB;gBACnB,IAAI,CAAC,SAAS;oBACZ,OAAO,IAAI,CAAC;gBACd;YACF,OAAO,IAAI,UAAU,cAAc;gBACjC,mBAAmB;gBACnB,OAAO,IAAI,CAAC;YACd;QACF;QAEA,OAAO;YACL,UAAU;YACV,aAAa,WAAW;QAC1B;IACF,GAAG;QAAC;QAAU;KAAO;IAErB,8BAA8B;IAC9B,IAAI,aAAa,gBAAgB;QAC/B,OAAO;IACT;IAEA,IAAI,WAAW;QACb,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC,iNAAA,CAAA,UAAO;gBAAC,WAAU;;;;;;;;;;;IAGzB;IAEA,IAAI,CAAC,iBAAiB;QACpB,OAAO;IACT;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC,sIAAA,CAAA,eAAY;;;;;0BACb,8OAAC;gBAAK,WAAU;0BAAc;;;;;;;;;;;;AAGpC","debugId":null}}]
}